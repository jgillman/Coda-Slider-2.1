/*
	jQuery Coda-Slider v2.0 - http://www.ndoherty.biz/coda-slider
	Copyright (c) 2009 Niall Doherty
	This plugin available for use in all personal or commercial projects under both MIT and GPL licenses.
	
	v2.1 - 'Carousel' sliding added by Joel Gillman - http://joelgillman.com/
*/
$(function(){$("body").removeClass("coda-slider-no-js");$(".coda-slider").children(".panel").hide().end().prepend('<p class="loading">Loading...<br /><img src="images/ajax-loader.gif" alt="loading..." /></p>')});var sliderCount=1;$.fn.codaSlider=function(a){a=$.extend({autoHeight:true,autoHeightEaseDuration:1000,autoHeightEaseFunction:"easeInOutExpo",autoSlide:false,autoSlideInterval:7000,autoSlideStopWhenClicked:true,carousel:false,crossLinking:true,dynamicArrows:true,dynamicArrowLeftText:"« left",dynamicArrowRightText:"right »",dynamicTabs:true,dynamicTabsAlign:"center",dynamicTabsPosition:"top",externalTriggerSelector:"a.xtrig",firstPanelToLoad:1,panelTitleSelector:"h2.title",slideEaseDuration:1000,slideEaseFunction:"easeInOutExpo"},a);return this.each(function(){var e=$(this),b=e.find(".panel").width(),j=e.find(".panel").size(),k=(a.carousel)?b*(j+1):b*j,f=0,m=false,l=0,c,g,i;if(a.dynamicArrows){e.parent().addClass("arrows");e.before('<div class="coda-nav-left" id="coda-nav-left-'+sliderCount+'"><a href="#">'+a.dynamicArrowLeftText+"</a></div>");e.after('<div class="coda-nav-right" id="coda-nav-right-'+sliderCount+'"><a href="#">'+a.dynamicArrowRightText+"</a></div>")}$(".panel",e).wrapAll('<div class="panel-container"></div>');$(".panel-container",e).css({width:k});if(a.crossLinking&&location.hash&&parseInt(location.hash.slice(1))<=j){c=parseInt(location.hash.slice(1));g=-(b*(c-1));$(".panel-container",e).css({marginLeft:g})}else{if(a.firstPanelToLoad!=1&&a.firstPanelToLoad<=j){c=a.firstPanelToLoad;g=-(b*(c-1));$(".panel-container",e).css({marginLeft:g})}else{c=1}}$("#coda-nav-left-"+sliderCount+" a").click(function(){f++;if(c==1&&!a.carousel){g=-(b*(j-1));h(j-1);c=j;e.siblings(".coda-nav").find("a.current").removeClass("current").parents("ul").find("li:last a").addClass("current")}else{if(c==1&&a.carousel){m=true;g=0;h(j-1);c=j;e.find(".panel:last-child").clone().addClass("duplicate").prependTo(".panel-container");$(".panel-container",e).css("marginLeft",-b);e.siblings(".coda-nav").find("a.current").removeClass("current").parents("ul").find("li:last a").addClass("current")}else{c-=1;h(c-1);g=-(b*(c-1));e.siblings(".coda-nav").find("a.current").removeClass("current").parent().prev().find("a").addClass("current")}}$(".panel-container",e).stop().animate({marginLeft:g},a.slideEaseDuration,a.slideEaseFunction,function(){if(a.carousel&&m){m=false;$(this).css("marginLeft",-(b*(j-1))).find(".panel.duplicate").remove()}});if(a.crossLinking){location.hash=c}return false});$("#coda-nav-right-"+sliderCount+" a").click(function(){f++;if(c==j&&!a.carousel){g=0;c=1;h(0);e.siblings(".coda-nav").find("a.current").removeClass("current").parents("ul").find("a:eq(0)").addClass("current")}else{if(c==j&&a.carousel){m=true;g=-(b*j);c=1;h(0);e.find(".panel:first-child").clone().addClass("duplicate").appendTo(".panel-container");e.siblings(".coda-nav").find("a.current").removeClass("current").parents("ul").find("a:eq(0)").addClass("current")}else{g=-(b*c);h(c);c+=1;e.siblings(".coda-nav").find("a.current").removeClass("current").parent().next().find("a").addClass("current")}}$(".panel-container",e).stop().animate({marginLeft:g},a.slideEaseDuration,a.slideEaseFunction,function(){if(a.carousel&&m){m=false;$(this).css("marginLeft",(b*(c-1))).find(".panel.duplicate").remove()}});if(a.crossLinking){location.hash=c}return false});if(a.dynamicTabs){i='<div class="coda-nav" id="coda-nav-'+sliderCount+'"><ul></ul></div>';if(a.dynamicTabsPosition==="bottom"){e.parent().append(i)}else{e.parent().prepend(i)}ul=$("#coda-nav-"+sliderCount+" ul");$(".panel",e).each(function(o){ul.append('<li class="tab'+(o+1)+'"><a href="#'+(o+1)+'">'+$(this).find(a.panelTitleSelector).text()+"</a></li>")});navContainerWidth=e.width()+e.siblings(".coda-nav-left").width()+e.siblings(".coda-nav-right").width();ul.parent().css({width:navContainerWidth});switch(a.dynamicTabsAlign){case"center":ul.children().each(function(n){l+=$(ul.children()[n]).outerWidth()});ul.css({width:l});break;case"right":ul.css({"float":"right"});break}}$("#coda-nav-"+sliderCount+" a").each(function(n){$(this).bind("click",function(){f++;$(this).addClass("current").parents("ul").find("a").not($(this)).removeClass("current");g=-(b*n);h(n);c=n+1;$(".panel-container",e).stop().animate({marginLeft:g},a.slideEaseDuration,a.slideEaseFunction);if(!a.crossLinking){return false}})});$(a.externalTriggerSelector).each(function(){if(sliderCount==parseInt($(this).attr("rel").slice(12))){$(this).bind("click",function(){f++;targetPanel=parseInt($(this).attr("href").slice(1));g=-(b*(targetPanel-1));h(targetPanel-1);c=targetPanel;e.siblings(".coda-nav").find("a").removeClass("current").parents("ul").find("li:eq("+(targetPanel-1)+") a").addClass("current");$(".panel-container",e).stop().animate({marginLeft:g},a.slideEaseDuration,a.slideEaseFunction);if(!a.crossLinking){return false}})}});if(a.crossLinking&&location.hash&&parseInt(location.hash.slice(1))<=j){$("#coda-nav-"+sliderCount+" a:eq("+(location.hash.slice(1)-1)+")").addClass("current")}else{if(a.firstPanelToLoad!=1&&a.firstPanelToLoad<=j){$("#coda-nav-"+sliderCount+" a:eq("+(a.firstPanelToLoad-1)+")").addClass("current")}else{$("#coda-nav-"+sliderCount+" a:eq(0)").addClass("current")}}if(a.autoHeight){panelHeight=$(".panel:eq("+(c-1)+")",e).height();e.css({height:panelHeight})}if(a.autoSlide){e.ready(function(){setTimeout(d,a.autoSlideInterval)})}function h(n){if(a.autoHeight){panelHeight=$(".panel:eq("+n+")",e).height();e.stop().animate({height:panelHeight},a.autoHeightEaseDuration,a.autoHeightEaseFunction)}}function d(){var n;if(f==0||!a.autoSlideStopWhenClicked){if(c==j&&!a.carousel){n=0;c=1}else{if(c==j&&a.carousel){m=true;n=-(b*j);c=1;e.find(".panel:first-child").clone().addClass("duplicate").appendTo(".panel-container");e.siblings(".coda-nav").find("a.current").removeClass("current").parents("ul").find("a:eq(0)").addClass("current")}else{n=-(b*c);c+=1}}h(c-1);e.siblings(".coda-nav").find("a").removeClass("current").parents("ul").find("li:eq("+(c-1)+") a").addClass("current");$(".panel-container",e).stop().animate({marginLeft:n},a.slideEaseDuration,a.slideEaseFunction,function(){if(a.carousel&&m){m=false;$(this).css("marginLeft",(b*(c-1))).find(".panel.duplicate").remove()}});setTimeout(d,a.autoSlideInterval)}}$(".panel",e).show().end().find("p.loading").remove();e.removeClass("preload");sliderCount++})};